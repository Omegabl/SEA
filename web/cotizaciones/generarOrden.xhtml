<!DOCTYPE html>
<html lang="es" xmlns="http://www.w3.org/1999/xhtml" 
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	  xmlns:p="http://primefaces.org/ui"
	  xmlns:f="http://xmlns.jcp.org/jsf/core"
	  xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
	<h:head>
        <meta charset="UTF-8" />
        <title>Enviar cotización | SEA</title>
        <link rel="shortcut icon" href="#{request.contextPath}/img/favicon.ico"/>
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1" />
        <h:outputStylesheet library="css" name="mdl-selectfield.min.css" />
        <h:outputStylesheet library="css" name="cotizaciones.css" />
        <h:outputScript library="js" name="mdl-selectfield.min.js"></h:outputScript>
        <h:outputScript library="js" name="toggleforms.js"></h:outputScript>
        <h:outputScript library="js" name="retroalimentacion.js"></h:outputScript>
    </h:head>
	<h:body>
		<ui:composition template="/templates/header.xhtml" />
		<f:view>
			<main>
				<h:form class="stepForm ordenProduccion" enctype="multipart/form-data">
					<section class="step">
						<h3 class="mdl-typography--headline">Datos de la orden</h3>

						
						
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                            <p:selectOneMenu value="#{cotizacionController.cotizacion.numeroCotizacion}" filter="true" filterMatchMode="contains" pt:required="required">
                                <p:ajax event="valueChange" listener="#{cotizacionController.obtenerDatosRegistroOrdenProduccion()}" update="ciudadEmision, cliente, e-mail, direccionCliente, datosCP" />
								<f:selectItem itemValue="" itemLabel="Seleccione" />
                                <f:selectItems value="#{cotizacionController.listaCotizacionesOrdenProduccion}" var="cot" itemLabel="#{cot.numeroCotizacion}" itemValue="#{cot.numeroCotizacion}"/>
                            </p:selectOneMenu>
                            <h:outputLabel class="mdl-textfield__label" for="numeroCotizacion">Cotización No.</h:outputLabel>
                        </h:panelGroup>

						


						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputText class="mdl-textfield__input" id="numeroOP" value="0000" disabled="disabled" />
							<h:outputLabel class="mdl-textfield__label" for="numeroOP">Orden de producción No.</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputText class="mdl-textfield__input" p:maxlength="32" id="ciudadEmision" value="#{cotizacionController.datosCotizacion[2]}" pt:disabled="true" />
							<h:outputLabel class="mdl-textfield__label" for="ciudadEmision">Ciudad de emisión</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputText pt:type="date" class="mdl-textfield__input" id="fechaEmision" value="#{cotizacionController.cotizacion.fechaEmision}" pt:disabled="true">
								<f:convertDateTime pattern="dd/MM/yyyy" />
							</h:inputText>
							<h:outputLabel class="mdl-textfield__label" for="fechaEmision">Fecha de emisión</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputText class="mdl-textfield__input" id="cliente" value="#{cotizacionController.datosCotizacion[1]}" pt:disabled="true" />
							<h:outputLabel class="mdl-textfield__label" for="cliente">Empresa</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputText class="mdl-textfield__input" pt:type="email" id="e-mail" value="#{cotizacionController.datosCotizacion[3]}" pt:disabled="true" />
							<h:outputLabel class="mdl-textfield__label" for="e-mail1">e-mail</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputText class="mdl-textfield__input" id="direccionCliente" value="#{cotizacionController.datosCotizacion[4]}" pt:disabled="true" />
							<h:outputLabel class="mdl-textfield__label" for="direccionCliente">Dirección</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputText class="mdl-textfield__input" id="asesor" value="#{loginController.mostrarNombreUsuario()}" pt:disabled="true" />
							<h:outputLabel class="mdl-textfield__label" for="asesor">Asesor</h:outputLabel>
						</h:panelGroup>
					</section>
					<section class="step">
						<h3 class="mdl-typography--headline">Artículos a solicitar</h3>
						<ui:repeat id="datosCP" value="#{cotizacionController.listaProductosCotizados}" var="item">
						<h5 class="mdl-typography--title fullWidth">Prenda 1</h5>

							<ui:repeat value="#{cotizacionController.listaProductosCotizados}" var="pro">
								<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
									<h:inputText class="mdl-textfield__input" id="referencia" value="#{pro[0]}" pt:disabled="true" />
									<h:outputLabel class="mdl-textfield__label" for="referencia">Referencia</h:outputLabel>
								</h:panelGroup>
								<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
									<h:inputText class="mdl-textfield__input" id="descripción" value="#{pro[1]}" pt:disabled="true"/>
									<h:outputLabel class="mdl-textfield__label" for="descripción">Descripción</h:outputLabel>
								</h:panelGroup>
								<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
									<h:inputText class="mdl-textfield__input" id="material" value="#{pro[2]}" pt:disabled="true"/>
									<h:outputLabel class="mdl-textfield__label" for="material">Material</h:outputLabel>
								</h:panelGroup>
								<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
									<h:inputText class="mdl-textfield__input" id="fabricante" value="#{pro[3]}" pt:disabled="true"/>
									<h:outputLabel class="mdl-textfield__label" for="fabricante">Fabricante</h:outputLabel>
								</h:panelGroup>
							</ui:repeat>
						</ui:repeat>


						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputTextarea class="mdl-textfield__input" id="descripcionColor" required="required" p:maxlength="512" />
							<h:outputLabel class="mdl-textfield__label" for="descripcionColor">Color</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputTextarea class="mdl-textfield__input" id="descripcionCuello" required="required" p:maxlength="512" />
							<h:outputLabel class="mdl-textfield__label" for="descripcionCuello">Cuello</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputTextarea class="mdl-textfield__input" id="descripcionBotones" required="required" p:maxlength="512" />
							<h:outputLabel class="mdl-textfield__label" for="descripcionBotones">Botones</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputTextarea class="mdl-textfield__input" id="observacionAdicional" required="required" p:maxlength="512" />
							<h:outputLabel class="mdl-textfield__label" for="observacionAdicional">Observaciones adicionales</h:outputLabel>
						</h:panelGroup>
						<h3 class="mdl-typography--title">Cantidad por tallas</h3>
						<h:panelGroup layout="block" class="fullWidth">
							<table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
								<thead>
									<tr>
										<th class="mdl-data-table__cell--non-numeric">Diseño</th>
										<th class="mdl-data-table__cell--non-numeric">Descripción</th>
										<th class="mdl-data-table__cell--non-numeric">Logotipo</th>
										<th>S</th>
										<th>M</th>
										<th>L</th>
										<th>XL</th>
										<th>Total</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td class="mdl-data-table__cell--non-numeric">Mujer Beige</td>
										<td class="mdl-data-table__cell--non-numeric">BASE DE LA CAMISA, MANGAS, Y BOLSILLO BEIGE. CUELLO, PECHERA, PUÑOS Y BORDE DE BOLSILLO EN VINOTINTO</td>
										<td class="mdl-data-table__cell--non-numeric">N/A</td>
										<td>10</td>
										<td>4</td>
										<td>2</td>
										<td>1</td>
										<td>17</td>
									</tr>
									<tr>
										<td class="mdl-data-table__cell--non-numeric">Hombre Beige</td>
										<td class="mdl-data-table__cell--non-numeric">BASE DE LA CAMISA, MANGAS, Y BOLSILLO BEIGE. CUELLO, PECHERA, PUÑOS Y BORDE DE BOLSILLO EN VINOTINTO</td>
										<td class="mdl-data-table__cell--non-numeric">N/A</td>
										<td>0</td>
										<td>7</td>
										<td>1</td>
										<td>0</td>
										<td>8</td>
									</tr>
									<tr>
										<td class="mdl-data-table__cell--non-numeric">Mujer Gris</td>
										<td class="mdl-data-table__cell--non-numeric">BASE DE LA CAMISA, CUELLO, PECHERA Y PUÑO GRIS. MANGAS Y BOLSILLO COMPLETO EN NEGRO</td>
										<td class="mdl-data-table__cell--non-numeric">N/A</td>
										<td>10</td>
										<td>4</td>
										<td>4</td>
										<td>2</td>
										<td>20</td>
									</tr>
									<tr>
										<td class="mdl-data-table__cell--non-numeric">Hombre Gris</td>
										<td class="mdl-data-table__cell--non-numeric">BASE DE LA CAMISA, CUELLO, PECHERA Y PUÑO GRIS. MANGAS Y BOLSILLO COMPLETO EN NEGRO</td>
										<td class="mdl-data-table__cell--non-numeric">N/A</td>
										<td>0</td>
										<td>11</td>
										<td>2</td>
										<td>0</td>
										<td>13</td>
									</tr>
								</tbody>
							</table>
						</h:panelGroup>
						<!-- input file-->
						<h3 class="mdl-typography--headline">Diagrama de diseño</h3>
						<img src="/img/diagramaDiseno.png" alt="" />
						<h:panelGroup layout="block">
							<h:inputFile id="diagramaDiseno" class="fileInput" value="#{cotizacionController.diagrama_diseño}" />
							<h:outputLabel for="diagramaDiseno" class="mdl-button mdl-js-button mdl-button--fab mdl-button--colored">
								<i class="material-icons">file_upload</i>
							</h:outputLabel>

						</h:panelGroup>

					</section>

					<h:panelGroup>
						<p:messages id="mensaje" autoUpdate="false" severity="info, fatal" showSummary="true" showDetail="true"/>
						<h:outputLabel for="txtcargarDia" value="Diagrama de diseño"/>
                        <h:inputFile value="#{cotizacionController.diagrama_diseño}" id="txtcargarDia"/>
                        <h:commandButton type="submit" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored" value="guardar" actionListener="#{cotizacionController.upload()}" />
					</h:panelGroup>


					<section class="step">
						<h3 class="mdl-typography--headline">Condiciones comerciales</h3>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputText class="mdl-textfield__input" id="lugarEntrega" disabled="disabled" value="En sus instalaciones" />
							<h:outputLabel class="mdl-textfield__label" for="lugarEntrega">Lugar de entrega</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputText class="mdl-textfield__input" id="tiempoEntrega" disabled="disabled" value="1 días hábiles enviada orden de compra y validado anticipo" />
							<h:outputLabel class="mdl-textfield__label" for="tiempoEntrega">Tiempo de entrega</h:outputLabel>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label fullWidth">
							<h:inputTextarea class="mdl-textfield__input" id="observaciones" p:maxlength="512" />
							<h:outputLabel class="mdl-textfield__label" for="observaciones">Observaciones</h:outputLabel>
						</h:panelGroup>
						<button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent toggleSubForm" type="submit">Generar orden de producción</button>
					</section>
				</h:form>


				<h3 class="mdl-typography--headline">Cantidad por tallas</h3>
				<!-- Usar <template> para los artículos a cotizar -->
				<p:commandLink styleClass="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent toggleSubForm" onclick="PF('dlg2').show();" value="Agregar tallas" />
				<a href="#addTallas" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent toggleSubForm">Modificar talla</a>
				<a class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">Eliminar</a>
				<h:form id="formTable" >
					<h:panelGroup class="fullWidth">
						<p:dataTable id="tablaP" var="producto" emptyMessage="No se encontraron registros"
									 value="#{cotizacionController.listaCotizacionP}" 
									 styleClass="mdl-data-table mdl-js-data-table  mdl-shadow--2dp " rowStyleClass="mdl-data-table__cell--non-numeric">
							<p:column headerText="Referencia">
								<h:outputText value="#"/>
							</p:column>

							<p:column headerText="Descripcion">
								<h:outputText value="#"/>
							</p:column>




						</p:dataTable>
					</h:panelGroup>
				</h:form>

				<p:dialog widgetVar="dlg2" id="cantidadTallas" >
					<h:form id="addCantidadTallas" class="mdl-dialog" enctype="multipart/form-data">
						<h3 class="mdl-dialog__title">Cantidad por tallas</h3>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                            <h:inputText class="mdl-textfield__input" id="diseño" pt:maxlength="100" pt:required="true" value="#{cotizacionController.diseño}" />
                            <h:outputLabel class="mdl-textfield__label" for="diseño">Diseño</h:outputLabel>
                        </h:panelGroup>

						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputTextarea class="mdl-textfield__input" id="descripcion" pt:required="true"  value="#{cotizacionController.productoEspecificacion.descripcion}" pt:maxlength="250" ></h:inputTextarea>
							<h:outputLabel class="mdl-textfield__label" for="descripcion">Descripción</h:outputLabel>
						</h:panelGroup>



						<h:panelGroup layout="block">
							<p:messages id="mensaje" autoUpdate="false" severity="info, fatal" showSummary="true" showDetail="true"/>
							<h:outputLabel for="txtcargarlog" value="Logotipo"/>
							<h:inputFile value="#{cotizacionController.logotipo}" id="txtcargarlog"/>
							<h:commandButton type="submit" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored" value="guardar" actionListener="#{cotizacionController.upload()}" />
						</h:panelGroup>


						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<p:selectOneMenu value="#{cotizacionController.idTalla}" id="talla">
								<f:selectItem itemValue="" itemLabel="Seleccione" />
								<f:selectItems value="#{cotizacionController.listaTallas}" pt:required="true" var="talla" itemLabel="#{talla.talla}" itemValue="#{talla.idTalla}"/>
							</p:selectOneMenu>
						</h:panelGroup>
						<h:panelGroup layout="block" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<h:inputTextarea class="mdl-textfield__input" id="cantidad" pt:required="true" value="#{cotizacionController.productoEspecificacionTalla.cantidad}" ></h:inputTextarea>
							<h:outputLabel class="mdl-textfield__label" for="cantidad">cantidad</h:outputLabel>
						</h:panelGroup>



						<h:panelGroup layout="block" class="mdl-dialog__actions">
							<p:commandButton actionListener="#{cotizacionController.agregarCotizacionProducto()}" value="Agregar" styleClass="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent toggleSubForm" oncomplete="PF('dlg2').hide();"/>
							<p:commandButton value="Cancelar" onclick="PF('dlg2').hide();" styleClass="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent toggleSubForm"/>

						</h:panelGroup>
					</h:form>
				</p:dialog>



			</main>
			<ui:composition template="/templates/navGeneral.xhtml" />
            <ui:composition template="/templates/taskTabs.xhtml" />
            <aside>
                <h:panelGroup layout="block" id="articuloAgregado" class="mdl-js-snackbar mdl-snackbar">
                    <h:panelGroup layout="block" class="mdl-snackbar__text"></h:panelGroup>
                    <button class="mdl-snackbar__action" type="button"></button>
                </h:panelGroup>
                <script>
					(function () {
						'use strict';
						window['counter'] = 0;
						var snackbarContainer = document.querySelector('#articuloAgregado');
						var showToastButton = document.querySelector('#mostrarArticuloAgregado');
						var handler = function (event) {
							console.log("artículo removido");
						};
						showToastButton.addEventListener('click', function () {
							'use strict';
							var data = {message: 'Artículo añadido a la cotización.', timeout: 5000, actionHandler: handler, actionText: 'Deshacer'};
							snackbarContainer.MaterialSnackbar.showSnackbar(data);
						});
					}());
                </script>

				<script>
					function limitTextArea(element, limit) {
						if (element.value.length > limit) {
							element.value = element.value.substring(0, limit);
						}
					}
				</script>
            </aside>

        </f:view>
    </h:body>
</html>
